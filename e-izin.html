<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>E-IZIN SMPN 110 JAKARTA</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
    <style>
        :root {
            --primary-color: #00C4CC;
            --bg-dark: #1e1e20;
            --input-bg: #252526;
            --border-color: #3e3e42;
            --danger-color: #ff4d4d;
            --success-color: #28a745;
            --wa-color: #25D366;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #0f0f10 0%, #1a1a1b 100%);
            margin: 0; padding: 15px; color: #ffffff;
            min-height: 100vh; display: flex; flex-direction: column; align-items: center;
        }
        
        header, .container { width: 100%; max-width: 950px; box-sizing: border-box; }

        header {
            margin-bottom: 15px; background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px); padding: 10px 20px;
            border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex; justify-content: space-between; align-items: center;
        }

        .nav-icons { display: flex; gap: 10px; }
        .nav-icons button {
            background: rgba(255, 255, 255, 0.1); border: none; color: white;
            width: 40px; height: 40px; border-radius: 10px; cursor: pointer;
            display: flex; align-items: center; justify-content: center; font-size: 1.2rem;
        }
        .nav-icons button.active-nav { background-color: var(--primary-color); }

        .container {
            padding: 25px; background-color: var(--bg-dark); 
            border-radius: 20px; box-shadow: 0 15px 35px rgba(0,0,0,0.5);
            border: 1px solid #2d2d30;
        }

        .section { display: none; }
        .active { display: block; }

        label { display: block; margin-bottom: 5px; font-weight: 600; color: #b3b3b3; font-size: 0.85rem; }
        input, select {
            padding: 12px; border-radius: 10px; border: 1px solid var(--border-color);
            width: 100%; background: var(--input-bg); color: #fff; margin-bottom: 15px;
            box-sizing: border-box; font-size: 1rem; outline: none;
        }
        
        button.btn-primary {
            padding: 15px; border: none; border-radius: 10px; width: 100%;
            background: var(--primary-color); color: white; font-weight: bold; cursor: pointer;
        }

        /* CUSTOM MODAL SYSTEM */
        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); z-index: 10000; justify-content: center; align-items: center;
            backdrop-filter: blur(5px);
        }
        .modal-card {
            background: #252526; padding: 30px; border-radius: 20px; width: 90%; max-width: 380px;
            border: 1px solid rgba(255,255,255,0.1); text-align: center;
            transform: scale(0.8); transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .modal-overlay.open { display: flex; }
        .modal-overlay.open .modal-card { transform: scale(1); }

        .modal-icon { font-size: 3rem; margin-bottom: 15px; display: block; }
        .modal-card h3 { margin: 0 0 10px 0; color: #fff; }
        .modal-card p { color: #b3b3b3; font-size: 0.95rem; margin-bottom: 25px; line-height: 1.4; }

        .modal-btns { display: flex; gap: 12px; }
        .btn-m { flex: 1; padding: 12px; border-radius: 12px; border: none; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-m-cancel { background: #3e3e42; color: white; }
        .btn-m-danger { background: var(--danger-color); color: white; }
        .btn-m-confirm { background: var(--primary-color); color: white; }
        .btn-m:active { transform: scale(0.95); }

        /* TABLE STYLES */
        .table-responsive { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; background: #fff; border-radius: 8px; overflow: hidden; margin-top: 10px; }
        th { 
            background: #2d2d30; color: var(--primary-color); padding: 12px; text-align: left; 
            cursor: pointer; position: relative; user-select: none; white-space: nowrap; font-size: 0.85rem;
        }
        th:hover { background: #3e3e42; }
        th::after { content: ' ‚Üï'; font-size: 0.7rem; opacity: 0.5; }
        td { padding: 10px; border-bottom: 1px solid #eee; color: #333 !important; font-size: 0.85rem; }

        .btn-mini-icon {
            width: 40px; height: 40px; border: none; border-radius: 10px;
            cursor: pointer; color: white; font-size: 1.1rem; 
            display: inline-flex; align-items: center; justify-content: center;
        }
        .bg-excel { background: var(--success-color); }
        .bg-danger { background: var(--danger-color); }

        @media print {
            .modal-overlay, header, .nav-icons, .btn-mini-icon { display: none !important; }
        }
    </style>
</head>
<body>

<div id="modalContainer" class="modal-overlay">
    <div class="modal-card">
        <span id="mIcon" class="modal-icon">üîí</span>
        <h3 id="mTitle">Konfirmasi</h3>
        <p id="mMsg">Silakan masukkan informasi.</p>
        <div id="mInputWrapper">
            <input type="password" id="mInput" placeholder="..." style="margin-bottom: 20px;">
        </div>
        <div class="modal-btns">
            <button class="btn-m btn-m-cancel" onclick="closeM()">Batal</button>
            <button class="btn-m btn-m-confirm" id="mPrimaryBtn">Lanjutkan</button>
        </div>
    </div>
</div>

<header>
    <h1 style="font-size: 0.9rem; margin:0;">E-IZIN SMPN 110 JAKARTA</h1>
    <div class="nav-icons">
        <button onclick="navKe('menuIsi', this)" class="active-nav">üìù</button>
        <button onclick="mintaAkses('menuWali', this)">üë®‚Äçüè´</button>
        <button onclick="mintaAkses('menuPiket', this)">üìã</button>
    </div>
</header>

<div class="container">
    <div id="menuIsi" class="section active">
        <div id="inputFormWrapper">
            <label>Pilih Kelas:</label>
            <select id="kelas" onchange="updateDaftarSiswa()">
                <option value="">-- Pilih Kelas --</option>
                <optgroup label="KELAS 7">
                    <option value="7 A">7 A</option><option value="7 B">7 B</option><option value="7 C">7 C</option>
                    <option value="7 D">7 D</option><option value="7 E">7 E</option><option value="7 F">7 F</option>
                </optgroup>
                <optgroup label="KELAS 8">
                    <option value="8 A">8 A</option><option value="8 B">8 B</option><option value="8 C">8 C</option>
                    <option value="8 D">8 D</option><option value="8 E">8 E</option><option value="8 F">8 F</option>
                </optgroup>
                <optgroup label="KELAS 9">
                    <option value="9 A">9 A</option><option value="9 B">9 B</option><option value="9 C">9 C</option>
                    <option value="9 D">9 D</option><option value="9 E">9 E</option><option value="9 F">9 F</option>
                </optgroup>
            </select>
            <label>Nama Murid:</label>
            <div id="containerNamaSiswa"><input type="text" id="namaSiswa" placeholder="Pilih Kelas Dahulu" readonly /></div>
            <label>Nama Orang Tua:</label>
            <input type="text" id="namaOrtu" style="text-transform: uppercase;" placeholder="NAMA LENGKAP PENGIRIM" />
            <label>Alasan Izin:</label>
            <select id="alasan">
                <option value="Sakit">Sakit</option>
                <option value="Izin">Izin (Urusan Keluarga)</option>
            </select>
            <button class="btn-primary" onclick="buatSurat()">Buat Surat Formal</button>
        </div>

        <div id="outputSection" style="display:none;">
            <div id="surat" style="background: white; color: black; padding: 30px; border-radius: 5px; font-family: 'Times New Roman', serif; line-height: 1.6;"></div>
            <div style="display:flex; justify-content:center; gap:20px; margin-top:25px;">
                <button onclick="resetForm()" class="btn-mini-icon bg-danger" style="width:55px; height:55px;">‚¨ÖÔ∏è</button>
                <button onclick="kirimWhatsApp()" class="btn-mini-icon" style="background:var(--wa-color); width:55px; height:55px;">üí¨</button>
                <button onclick="window.print()" class="btn-mini-icon" style="background:var(--primary-color); width:55px; height:55px;">üñ®Ô∏è</button>
            </div>
        </div>
    </div>

    <div id="menuWali" class="section">
        <h3>Rekapitulasi Wali Kelas</h3>
        <div class="table-responsive">
            <table id="tableWali">
                <thead>
                    <tr>
                        <th onclick="sortTable('tableWali', 0)">Kelas</th>
                        <th onclick="sortTable('tableWali', 1)">Nama Murid</th>
                        <th onclick="sortTable('tableWali', 2)">Tanggal Izin</th>
                        <th onclick="sortTable('tableWali', 3)">Ket</th>
                    </tr>
                </thead>
                <tbody id="listWali"></tbody>
            </table>
        </div>
    </div>

    <div id="menuPiket" class="section">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
            <h3 style="margin:0;">Database Piket</h3>
            <div style="display:flex; gap:8px;">
                <button onclick="exportCSV()" class="btn-mini-icon bg-excel">üìä</button>
                <button onclick="konfirmasiHapusSemua()" class="btn-mini-icon bg-danger">üóëÔ∏è</button>
            </div>
        </div>
        <div class="table-responsive">
            <table id="tablePiket">
                <thead>
                    <tr>
                        <th onclick="sortTable('tablePiket', 0)">Kelas</th>
                        <th onclick="sortTable('tablePiket', 1)">Nama Murid</th>
                        <th onclick="sortTable('tablePiket', 2)">Tanggal Izin</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody id="listPiket"></tbody>
            </table>
        </div>
    </div>
</div>

<script>
    const PASS_WALI = "wali110", PASS_PIKET = "piket110";
    let targetMenu = null, targetBtn = null;
    let currentData = null;

   const dataSiswa = { 
        "7 A": ["ABDUL FATAH NASUTION", "ABDURRAHMAN ALFARIZI", "ADDA KAAYUAN AULIA CAKRA NIRMALA", "AHMAD FACHRI FIRMANSYAH", "AINNUR FADZILLAH", "AISHAVIRA SALSABILA", "ARDHYASTHA PRASETYA", "AZKA IBRAHIM", "CARISSA ALYA FERICA", "CHARISSA AGLESSIA PUTRI", "DIMAS PUTRA SETIAWAN", "EMIRA KHAIRUNISA", "FITRI YAUMI", "GAGAH ADHI PRAKOSO", "JANETHA PUTRI ADELLIA", "KAHLA GHAISA SHIBA", "KIMIKO AZURA YUSELL", "LOLITA AURORA HADI", "MAHIRA HANDAYANI", "MUHAMAD RIZKI", "MUHAMMAD ALIM RAAFI", "MUHAMMAD ERLANGGA SYAQIB", "MUHAMMAD FADHIL ARSYAD", "MUHAMMAD FAREEZ PRATAMA", "MUHAMMAD NIZAM", "NALENDRA ZAKI MUBARAK", "NAYSYILLA INNAYAH", "PRICELLIA FAUZIAH", "RANDHIKA REZKY WAHYUDI", "SABIAN FATAYA ADAM NUGRAHA", "SATRIA CAHYA ANGGARA", "TANIA PUTRI CHRISTVIE", "TRI YUSUF JAMAL LUDIN", "USAMAH", "ZAHFA SYACHQILIA"],
        "7 B": ["ATHAYA KHANSA BATUBARA", "AZRI SANI ATHALLAH", "BIMA RAMADASKA NURZAFRAN", "FAKHIRAH SALWA NABILA HAKIM", "HANYYA MIRFA FADLI", "HUMAIRAH AULIA RAMADHANI HILMI", "IRFAN PRASETYA", "JIBRAN NARARYA PUTRA", "KANZANIA ZIEVARA AKHMAD", "KAYLA MANTIKA HERMANSYAH", "KHALIFAH RAMADHANY", "MICHAEL RAHMAN MANOPPO", "MIKAYLA AL RASYID FEBRIANA", "MUHAMAD LATIF ALBANY PASARIBU", "MUHAMAD RIZKY ALFADILLAH", "MUHAMMAD AZZAM RAZIQ", "MUHAMMAD DAFFA ALFARIZKI", "MUHAMMAD SYAILENDRA IBRAHIM", "NADIA ALANNA IRAWAN", "NAPSAH DJUNAIDI", "NOVA ZARA PRAMUDITA", "NOVAL AHMAD DHANI", "RAHMANIA AZZAHRA", "REVALINA ALMAIZA FADILLAH", "RIDHO ABIYU KAFI", "RIFKI NURIL HUDA", "RIFQI AZZAM SAPUTRA", "RIZKY NURSYAWALI", "SALSA APRILIA PUTRI", "SYAFA HALIZA PUTRI", "SYAFIA NAYLA ZAHRA", "VIKRYZAKY ARIZA", "YAKE FAIN SETO", "ZAKY ALFARIDZI AHMAD", "ZAVIRA MESYA GRANADA", "ZIVARA KANAYA LETISHA"],
        "7 C": ["AHMAD DAMEER", "AINA NAJWA RAMADHANI", "ALIFAH NADA ISLAH", "ANANDA SYIFA FADILLAH", "ASYIFA HALWA ALI", "BOB WELLSON DUMATUBUN", "CINTA SALSABILA", "DEMETRIO SPARTACUS FALCAO", "ELSA NOVIANA", "FATHIR ZAIN MUSADEC", "GHISELLA NUR APRILLIA", "HAFSHOH USWATUN HASANAH", "HAIKAL FAJAR PRATAMA", "IBNU SABIL", "KANAYA PUTRI SYABILLA", "KEANNO DEAN NEYMAR", "KENZO PERWIRA", "KHANSA HUMAIRA", "MAULANA MALIK IBRAHIM", "MAYKO KOENT MOSES BASKORO", "MUHAMMAD ALIF ZIAD", "MUHAMMAD ARIF RAHMAN", "MUHAMMAD AZKA ALFATHAN", "MUHAMMAD DHUKE NAZMI", "MUHAMMAD FAIDZ AIRLANGGA", "MUHAMMAD FATAR RAHMAN", "MUHAMMAD HAIKAL RAMADHAN", "NAURAH HASNA SALSABILA", "RAFA RIZKI MAULANA", "RAFIF PANGGIH PANGESTU", "RAYSKA NURAISYAH PUTRI", "RUSMIN NURYADIN", "SABIL RIZQ ARRAHMAN", "SHALSA BILLAH KAYLA IBRAHIM", "ZAZKIA RAMADANI SUTRISNO", "ZHAFRAN RIZIQ ARGANI"],
        "7 D": ["AHMAD FARIS", "ALIVYAN AISY PUTRA", "ANDREAS DARYA CHRISTOPER", "ARDIANSYAH RAMADHAN", "ASTI NADYA KAMILAH", "ATHIRA SABRINA", "AZZAM DZULHANAN MUZHAFAR", "BAMBANG HARY BOWO", "CAHAYA KARUNIA", "DESTRY PRAMUNINGRUM", "DEVINA PRAMESHA", "INARA AYUDIA MAHESTRI", "JASMINE CITRA JULIANDITA", "KENZIE ADESYA MALIKA", "KEVYN ADITYA KAMIL", "KHALID FAYYADH RAMADHAN", "KHARIN QURATU AINI", "KHOIRUN NISA ASYSYIFA", "LUTHFI SAKHI ZAIDAN HAKIM", "LYUDMILA METIA", "MOHAMAD RIZQI ALIFI", "MOHAMMAD AL-FARIZI", "MUHAMMAD ARMAND ALBANI", "MUHAMMAD ATHIR ARRAFI", "MUHAMMAD FABIAN NURFADILLAH", "MUHAMMAD FAISAL ADITYA", "MUHAMMAD TRIO ARDIANSYAH", "MUHAMMAD VISURGA", "NASYA SAZWINA PUTRI", "RAFARDHAN AQILA SAKHI", "RAVA AIZAM", "RAYZH IRSYAD RAMADHAN", "SHAZMI RACHEL NOVALIZA", "SYAFIQA ADZKIYA MAHREEN", "SYAFIRA ATHALLAH DYU", "ZAHRA PUTRI SALSABILA"],
        "7 E": ["AHMAD RAFIQI", "ALEA NATASHA RIZKY", "ALIF APRILIO", "ANDARA NAYARAPUTRI DJABAR", "ARBHIAN NATHAN FAREZI", "AWALIA RAMADHAN", "BILAL YOJIE GUNAWAN", "BIMA PRASETYO", "DAFFA AZKA ATHARRAYHAN", "DELLA SAKINAH AZZAHRA", "FIRA KHOLIFAH", "HAWARI ALTAF RIZKY", "INDY FITRIANSYAH", "JAFAR NIZAM ALFATIR", "JONATHAN DOKSEN SIAGIAN", "JULIA RACHMADANI", "KAYLA MEIDYNA", "KENZI AKHTAR ALMALIKI", "KENZOE JOSUWA PRATAMA", "MICHELLE NATHANIA MARCHIANO", "MIKHAYLA RAMAHDANI ARYANTI", "MUCH ZIDNI ILMAN", "MUHAMAD RIFKI", "MUHAMMAD ARSYAD", "MUHAMMAD BIMMA ALFARRO", "MUHAMMAD TSAQIF MAULANA", "MUTIARA OLIVIA BORU SINAGA", "NAUVIAN RUBY NUGRAHA", "PRADIPTA BINTANG KANEISHIA", "RAFAN ADHIRA ABQARY", "RAYSA DELIA", "SAFAROUSH CELESTA ASHALINA", "SAHRANIA INSAN MAZSAID", "SITI ANGGRAYNI", "SYALWA INDIRA WALDY", "VANIA ANINDHITA LARASATI"],
        "7 F": ["ACHMAD KURNIAWAN", "ADINDA ZAFIRA HIJRIYAH", "AHMAD HABIL", "ASHRAFFA MAHER SYAWAL ARIYONO", "AULIA PUTRI CANTIKA", "BAIHAQI NIZAM", "DZAKIRA FAHIMA", "FAKHRIE ZHAFRAN KHAIRIE", "FATHIR ALTAN SYAH", "FITRI AULIA SURYA", "IHSAN MAULANA", "JASMINE ANINDYA RAMADHAN", "JESICA DWI LESTARI", "JULIAN RAMADHAN", "KEYZA AZKA ZAHIRAH", "KINAR AULIA SOULIHATI", "MUHAMAD ARKAN IBRAHIM", "MUHAMAD PANCA ABRASYAH", "MUHAMMAD FATHURROHIM ZAMIL", "MUHAMMAD ILHAM AFRIANSYAH", "MUHAMMAD IMAM MUSTHAFA", "MUHAMMAD NUH DZAKIYY ABIDIN", "NADHIF RAIHAN PRASETYO", "NADIYAH FAKHIRA SHIBA", "NAFIL RAMADHAN", "NAYLA ANASTASYA", "NOVI ZHAFIRAH PRAMUDITA", "NUR AULLYA RAMADHANI", "NURUL RAHMAH ZULFAN", "SYARIFAH HANAFIAH ALATAS", "SYIFA LAILLIYAH SYAFIRA", "TALITHA DHIYA SYARAFANA", "TEGAR NURMA WANTO", "WINDA SRI HANDAYANI", "ZAHRO MAULIDA"],
        "8 A": ["ABEL GHANI ABRAR", "ABIGAIL ADELIA DIMITRI HUTASOIT", "ADINDA NUR AZIZAH", "ANDINA SYAHIRA", "ARKANA ADNIELL PRATAMA", "ARLIKA PUTRI EFFENDI", "ARROFAIZ AHMAD NUZULUL MARDIKA", "AZAM NUR RAMADHAN", "CALYA HAFIDZAH DJUNAIDI", "CESAR PUTRA KINARYA", "ELANG OKTA PRATAMA", "EZIZA ELYA EZZATY", "FADHIL ASRI", "HAURA SYIAH KASIFAH SYARIF", "HERI FAHRI MAULANA", "JIHAN MAULIDA PUTRI", "KAFIN AHMAD NURYADIN", "KHADIFA SALSABILA", "MEIZKA ADINDA PUSPITA HATI", "MUHAMMAD FACHRI SAPUTRO", "MUHAMMAD GALLIH AVRYAN", "MUHAMMAD HIDAYATULLAH", "MUHAMMAD RAMADHAN", "MUHAMMAD RIZKY ADITYA", "NADIYA NURAIDAH", "NURUL RAFIKA AULIA HASANAH", "PETRIS AUREALY DABET", "SASMA ANANDITA NAYA", "SHAFA NADHILAH ZEIN", "SHAKEELAH NAFEEZA ROSA", "SOLAHUDDIN NASUTION", "SYALWA MULYA SARI", "UZUMAKI YUSRA AZZAMI", "VIRGI AZKA PUTRA EVLI", "ZAHRITA NURHAIDAH", "ZEA ZENOBYA RACHMA"],
        "8 B": ["AIRA ANISTIYA", "ANDINI THYMYTHA PUTRI", "ARENSKY PUTRA SANDEGA", "ARKA BHIRAWANGGA ZOE", "AULIA RIZY RUMADANI", "CECILLIA ANGELICA HUTASOIT", "CHERYL AMALIA JASHINDA", "DAFFI NUR FIRJATULLAH", "FIXO YOSSI FAIQ AL HAKIM", "HILMI SYAFA ANISA PUTRI", "ISMI YULIANTI", "KIRANA ANJANNY", "KIRANA PUTRI LODI", "LINTANG PRAMUDYA NAFEEZA", "MAIZA AILA SYAHRIAL", "MOHAMMAD ARFANSYAH", "MORINO SETIAWAN", "MUHAMMAD AINNUR RAZAK", "MUHAMMAD MARVEL PRATAMA VANCOUVER", "MUHAMMAD RAFFA RAMADHAN", "NADJLA AURELIASYAH", "NAKEISHA ARDELIA", "NASTASYA LAKHISYA", "NASYWAH HAYA THALIHAH", "NIZAM SEPTIAN RIZKY", "OWEN ALFARISI", "QYARA ALZENA NEZAVISLY", "RADITHIA RAMADHAN", "RAISA RAIHANA", "RHEVAL RADITIA ANDREANSYAH", "SAFA KHADIJAH MOOSA", "SATRIO BAYU AJI", "SEKAR ARUM ALIFA", "SITI DHAWIYAH A'ZAHRA", "TENGKU RAHLIL MUSTAQIIN", "WILDAN ANAS PRANATA"],
        "8 C": ["ABU BAKAR", "AMELIA PRILANI", "AMIRA OCTAVIANI", "AQILAH NUR ALHANI", "ARNETA DYFA PUTRI", "ASSYFA ADELIA EVIANTY", "AVRILIA DWI KHASANAH", "BYAN SARAH NABILA", "CARISSA ELVINA SUKANDAR", "DANISHA NUR UMAIRAH SYAHMINA", "DANISWARA IQSHAN LEE", "DAVITHO ARBY SAHPUTRO", "FATHIR AFSARUL FUAD", "FINONA ANDERESTA MAHESWARY", "FIRAS FAIQ USMAN", "GHAIDA SABRINA RAHMAN", "GUSTY RAMADHAN", "IRSYAD ABDUL QADAR", "JOSAPHAT CRISTIANO DWINIELRI HUTAURUK", "KEANU RIFANDI", "KELVINO RAIHAN SETYOHADI", "KYLA SAGITA", "LAURA SALMA AGNESA", "MUHAMAD EKA RAMADHAN", "MUHAMAD HAZIQ", "MUHAMMAD ALIF KAUTSAR IBHAMA", "MUHAMMAD NIHAYAH ZAIN", "MUHAMMAD SULTAN KHALISH SETIANTO", "MUHAMMAD ZAINUL FIKRI", "NABILA PUTRI AULIA", "RADITYA AFFAN BURHANUDIN", "RAISA NADA NUR AULIA", "SAKHA ADHYASTHA RAMADHAN", "SYIFA MAIMUNAH MOOSA", "WILDAN KABIR AQIEL", "WULAN DARMAWANTY"],
        "8 D": ["ABDUL HADI", "ADIB FAWWAZ ERSAKTA", "AHMAD NAUFAL RIDHO", "AISYAH ZAHRA MAULYDA", "ANJAR SAPUTRA", "AZA SHAKILA AMELIA", "BRIAN AR-RAFI", "BUNGA ALMA AMEERA", "DAFFA NUR HIBATULLAH", "DIANA TRI OKTAVIANI", "ERIKA APRILIA", "FAJAR PRATAMA", "GEOVANI LIONEL KENZIE", "HABIBIE AL FAIZAR ROHMAN", "IANUAR NUGROHO TRIWICAKSONO", "JULIANA PUTRI", "KAYYISAH AQILAH GUSTAMI", "KHAIRUNISA HABIBAH", "MUHAMMAD ABDU NURBARI", "MUHAMMAD KHADAFI", "MUHAMMAR RIZKY RAMADHAN", "NADIA KAMILAH", "NADIN SALSABILA", "RAFA MUHAMMAD ZEIN", "RAMA ARIANDES", "RAYYAN KAHIL FALAH", "RIZKY FADHILLAH YUSUF", "SABRINA AMANDA PUTRI", "SALFAH FITRIANSYAH", "SALSABILLA OKTAVIANI", "SASHIRA FITRIANI RAHAYU", "SILMI ZAHRATUNNISA", "SITI TALITA HASNA", "SYIFA NABILAH ZEIN", "THALITA FITRINADYA INDRAWAN", "ZAKY ARDIANSYAH"],
        "8 E": ["ABYAN PUTRA YUDAKSANA", "AIMAR RIZKI YUDHISTIRA", "ALIFIAH NADIYAH RAMADHANI", "ALLEA SIFARAMADINA", "ANNISA SEPTIANI", "AZZIKRA ADITYA SYAHPUTRA", "BRYAN APRILLIO SAPUTRA", "CHAIRUL NIZAM", "DON JULIO DOKSEN SIAGIAN", "FAIZ BUDI MAULANA", "HAFZA FAIZAL TAMIR RAFFA", "HARTAWAN TRI WICAKSONO", "INMA ANAYA HARDJANTO", "INTAN NURAINI", "JELITA DWI HARYAWAN", "JOSHUA DEFFANKA", "KAMILA OKTAVIANI", "KHANZA APRILIA", "MAHISYA RINDU HARI RIZKIA", "MUHAMAD PUTRA RAMADAN", "MUHAMMAD HILMI RAMADHAN", "MUHAMMAD RAFKA APRILLIO", "MUHAMMAD RIZKY FEBRIMKA", "MUKHAMAD RIZKY FABIANO", "NADIA RISKA AMANDA", "NAZWA REFALI SONATA", "NICOLE HALWA AZZAHRA LUBAY", "PUPUT ADI PUTRA", "RAFIF SABIAN", "RAHMA ZAKIA NOVALISA", "SAVANA ALYA", "SURFINA MARDIYANA", "SYAFIRA OKTAFIANI", "SYIFA RAMADHANI", "WAHYU EKA PRASETYO", "WINDI ALVIANTI"],
        "8 F": ["AHMAD MAULANA", "ALBIBIT DESWAN RUSIANTO", "ALPHAN FADILLAH", "ALYA ALFARIDA", "AUDRY AZKA ZAFIRAH", "AYRA ADINDA PUTRI", "BUNGA SHAFARANTI", "CAHYA EKA SAPUTRI", "DARREN YUSUF ANDRIAN", "ELISHA CHRISTA", "FASHILA HUSNA", "GHALI ALTHOF", "GILANG MANGKU YUDHA", "HABIL KUSWOYO PUTRA", "HAFIDZUL AZMI FUADI NOVALDIANSYAH", "JONATHAN WIRATAMA", "JOVANZA ARYA WINATA", "KHANZA AULIA SHAFA", "KIMORA ATIERA SALITA", "MUHAMAD DENDI FRATAMA", "MUHAMMAD BAIKI JOHANSAH", "MUHAMMAD FATAN FABIAN PUTRA PRIYANTO", "MUHAMMAD KENZIE ABDUL BASIET", "MUHAMMAD WILDZAN M MAULANA", "NADIA TSAMARA", "NUR SALSABILA HASIBUAN", "PUTRI AMELIA KHOIRUNNISA", "QUEENA ALAAMA FISAABI", "RATU AGISKHA SYAHARA", "SAMANTHA NAFA RASHEESA", "SYAQILLA KHAIRUNNISA", "SYIFA HERIANA PUTRI", "YASMIN ZHAFIRA RAMADHANI", "YUSUF SALMAN ABBAD", "ZAHRAN FAYYADH RAMADHAN", "ZAHWA ALIYA NAJYA"],
        "9 A": ["ABDUL HAKIM", "ALI JABBAR FIRDAUS", "ALIF NUR RAHMAT", "ANINDYA DZAKIYAH RAFIFAH", "ARI GILANG ROMADHON", "ATHAYA AZMI PRAYATA", "AZALEA MEISYAHIRA", "BELLICIA LIVIANA NAFEEZA", "DAVE LIANO CHANIA", "DAVINA SYAHIRA MAHARANI", "DEFA SEKAR ARUM", "DICNA VIOLA RAMADHANI", "FATIMAH AZZAHRA", "IDRAKI PUTRA ARIANTO", "KAMILA AININDYA PUTRI", "KAMILA NURHADIYATI", "KAYLA DIANDRA NAJMATUNISSA", "KENZO LAURENZI TONVI", "M. FIZLY ARAHMAN", "MUHAMMAD ATSILKA ALGHANI DONALD", "MUHAMMAD FADLI DHARMAWANSYAH", "MUHAMMAD JAZULI AZIZY", "MUHAMMAD RAFA ADITYA", "NAYCILLA AISYAH PURNOMO", "QANNZA FAIRUZA AZKIA", "RALFA NATHAN AL PARIZI", "RATU GABBY APRILIA", "RAVQY PUTRA SUGIYANTO", "RIDWAN OKTOFABIAN", "RISKIYAH MAHARANI PUTRI", "SYAHLA ANINDYA CAROLLINE", "SYALUNA NURI QOLBI", "TEGAR MAULANA", "TENGKU PASHA AL-VIAN", "TRI RAHAYU RAHMAWATI", "ZAIDAN RIZKIANTO"],
        "9 B": ["AGUS RAMADHAN", "ALDI PUTRA DJIPTO", "ALIFAH NUR'AINI", "ALMIRA HASANATUL HAYYAH", "ALVIN ADITYA SAPUTRA", "AXEL ZHAFRAN", "AZIZUL HAFIDZ", "AZRIL ADITYA SAPUTRA", "CARISSA LAREIN", "CHAIRUNNISA SAFITRI", "CLARA LASMAULI MUTIARA TINAMBUNAN", "DAVINA PUTRI UTARI", "DINDA ZAKKIYAH PRAKASTIWI", "FAIRUZ AZRIEL FACHLEVI", "FIRYA IZZATI", "GHIFARY ANIBAYSYAH LEVI", "GRIMEZA AZIZAH ALDYAMIRU", "ILHAM DWI NUR LATIF", "KHANSAA DHILA", "MALIKA SYAHIRA AGFA", "MARVIN SA'DAN WIEKY WIBOWO", "MEISSA QURRATUL AINI", "MUHAMMAD AYYUBI SAFARAZ", "MUHAMMAD JAUHAR AL-KAHFI", "MUHIMAH ASMAN", "OCKTAVIA RIYADI PUTRI", "RADITYA RAGA HERLAMBANG", "RAFFA ADHITYA", "RAFFIANSYAH LUBIS", "RATHU ZALVARAYNA ALVINA", "REZA ANANDA PUTRA", "SAFA ANNISA", "YASMIN NURZAHRA", "ZAKI SATRIA ROSADI", "ZHAFIRAH AQILAH RANIYAH", "ZHEVANA PUTRI DENIAR"],
        "9 C": ["ALDRY GHOFARDAN", "ALEXANDER AGUNG", "ALVIN MOHAMMAD KHASAFANY", "ALVIN RAMA PRAYOGA ADISUCIPTA", "ANINDIA NAHDATUL AKMAL", "BINTANG ANDROMEDA", "CALLYSTA PERDANA CAHYA ANUGRAH", "DESWITA PUTRI RACHMADIANI", "DIANA PERMATA PUTRI", "DIANA SRI RAHAYU", "FIANDRA ANINDYA HENRYANI", "GHIFARI PRATAMA", "GHUSTI FITRAH MARDIANSYAH", "GUSTI AYU NIGIE SHABRINA PUTRI", "IQLIMA AURELIA EL RASYID", "IRZHA FIRMANTO", "KEISYHA CAHAYA PUTRI PRATAMA", "KENNY HILMI ALMANNAN", "KEYLA NATASYA ARDIKA", "LENTIK OLIVIA", "LINTANG WAHYU ANGGORO", "LIONEL EVAN RAFSANJANI", "MARITZA ARETHA RAJNI BASKORO", "MICCHAILA ZIVARA LUBAY", "MUHAMAD PANJI AKRAM SYAH", "MUHAMMAD SOFIAN", "MUJAMMIL AKBAR", "NABILA NURKHALIFAH", "NAJAT IHSAN HABIBAH", "NESSA NADRA", "NIZAM HADZAMI MAZSAID", "NUR QOLBI QAULAN KARIMA", "REIFA HAMID AL AZIZ", "ZEEVANYA DEVEGA CHANDRA"],
        "9 D": ["AGIS PRADITA", "ANNISA KHAIRANI", "AZURA CHILLA", "DZAIDAN MANSIZ", "FATHAN PUTRA KURNIA HAKIM", "FATHIR ALI", "HAFIZAH KHAYYIRAH LUBNA", "HANIF JULIAN YUSUF", "HARLAN PADLIANSYAH", "JASMINE ADARA METAVANI", "KIRANNA RIZKYA ANANDA", "LATIVA HELMI", "MAHESSA AYU KIRANI", "MARISA AZZAHRA", "MICHAEL FARUKH NASYHAN", "MUHAMMAD FAIRUZ AL WAHIB", "MUHAMMAD FAKHRI", "MUHAMMAD FAUZAN IBRAHIM", "MUHAMMAD GAHTAN", "MUHAMMAD HAFIDZ", "MUHAMMAD JAGA NUR ARDIYAALLAH", "MUHAMMAD RAFI AZHAR", "NAJMI FILLAYLI", "NAYLA RAHMATUL AZZA", "PUTRI CALLYSTA SALSABILLA", "PUTRI LAILA", "RAFA AL-FAIZ", "RAFA BAEHAQI", "RAFA FAUZAN KAMIL", "RAFAEL JULIANTO", "RASYA NURALI HADI", "REISYAH TRI RAFUDIN", "RESHA ELVITA", "SACHI PUTRI STEFANY", "SASKIA NAMIRA ZAHRA", "VIRLY AINUN NURRAHMA"],
        "9 E": ["ABDUL MUHAMMAD RAMADHANI", "ABDUL RAZZAQ AL HAMID", "AHMAD FAHRI MUSDAR CANIAGO", "AIRIN SHAFIRA ARIFIN", "ALFAJRI NUR RAMADHAN", "ALIEF SYAHPUTRA", "AQUILA NUR VIDI", "ATHA NAOMIRA CARISSA", "CHICO ALVARO PHUNG", "DECHA AYU NOVIOLA DASRIL", "DELICIA RIFDAH ANDITY", "ELFATH MUHAMMAD RABBANI", "FAHRI WINATA", "HAFIZAH ALFIANI", "HAFIZH FATHIN AVERO", "HAIQAL HAMZAH", "KAFFAH ZULYANTO", "MARISYA DWI ANGGRAINI", "MUHAMAD IRZAM ADIANSYAH", "MUHAMMAD PUTRA WIJAYA", "MUHAMMAD RAFA IRAWAN", "PUTRI ANNORA CASTELIN", "PUTY RIZKYNA HERMALIA", "RADEN ALFIYAH KHANSA", "RISKHA SAMILATI", "SAHLA MAULIDA SAFFANAH", "SALSABILA ALSAFA", "SEMY ARDI WIRANATA", "SHAFEEQAH", "SHERLY DWI THIRTA PUTRI", "SHIRA FITRI NURAINI INDRIANTO", "VIRGY ANINDYA REDHA", "WINDA ANISA PUTRI", "YUDHISTIRA PRAYOGA", "ZAKY WILDAN KHUSAENI"],
        "9 F": ["ALIF DARY ARDHANA", "ALKA NEARRA TAWASALNA", "AMANDA SEPTIA", "ANGGITA KHAIRUNNISA", "ANNISA GHASSANI", "ANUGRAH ANINDYA ROSIDIN", "ARAUFA TIARA", "AULIA SAFIRA RAMADHANI", "BILQIS NURUL QOLBI AL HAKIM", "DEVI ANGGRAENI", "DIMAS FAHRI", "DZHUHRI KHAIRULAZAM", "EL JABBAR GIBRAN WIBOWO", "FARIS ANWAR SOFIAN", "FAYA RISTANIASIH", "INTAN ALTHAFUNNISA", "KAFA ARVI MUAZAROH", "KEYLA FAIRUZ MAZIDAH", "LIVIANA MARSHA", "MIKHAELLA NUR KAMILAH", "MUHAMMAD AKHMAL RAMADHAN", "MUHAMMAD AZKHA SURYA RAMADHAN", "MUHAMMAD DAFFA AFIPUTRA", "MUHAMMAD NUR IHSAN", "MUHAMMAD SYAROF RIZQULLOH", "MUTIARA AZAHRA", "NADIN VINA VIRMANDA", "PANDYA RESWARA PUTRA IRAWAN", "PUTRI PUJIASTUTI", "RIZKY AKBAR RAFA PUTRA", "RYUKI RIFQI HARTANTO", "SHAFA NOVIYANTI", "SHEZA DESTIARA HANDOKO", "VICKA WARDAH FEBRIANA", "WAHYU MARTINO", "YOGA PRAMESTA HAIKAL PUTRA"]
    };

    // SYSTEM MODAL HANDLER
    function openM(config) {
        document.getElementById('mIcon').innerText = config.icon || '‚ÑπÔ∏è';
        document.getElementById('mTitle').innerText = config.title;
        document.getElementById('mMsg').innerText = config.msg;
        document.getElementById('mInputWrapper').style.display = config.showInput ? 'block' : 'none';
        document.getElementById('mInput').value = "";
        
        const btn = document.getElementById('mPrimaryBtn');
        btn.innerText = config.btnText || 'Lanjutkan';
        btn.className = 'btn-m ' + (config.btnClass || 'btn-m-confirm');
        btn.onclick = config.onConfirm;
        
        document.getElementById('modalContainer').classList.add('open');
    }

    function closeM() { document.getElementById('modalContainer').classList.remove('open'); }

    // LOGIN AKSES
    function mintaAkses(id, btn) {
        targetMenu = id; targetBtn = btn;
        openM({
            icon: 'üîí', title: 'Akses Terbatas', msg: 'Masukkan password petugas:',
            showInput: true, btnText: 'Masuk', onConfirm: cekPassword
        });
    }

    function cekPassword() {
        const pass = document.getElementById('mInput').value;
        if((targetMenu === 'menuWali' && pass === PASS_WALI) || (targetMenu === 'menuPiket' && pass === PASS_PIKET)) {
            closeM(); navKe(targetMenu, targetBtn);
        } else { alert("Password Salah!"); }
    }

    // KONFIRMASI HAPUS MODERN
    function konfirmasiHapusSatu(id) {
        openM({
            icon: 'üóëÔ∏è', title: 'Hapus Data?', msg: 'Data yang dihapus tidak dapat dikembalikan.',
            showInput: false, btnText: 'Hapus Sekarang', btnClass: 'btn-m-danger',
            onConfirm: () => {
                let s = JSON.parse(localStorage.getItem('absensi_110')).filter(i => i.id !== id);
                localStorage.setItem('absensi_110', JSON.stringify(s));
                closeM(); renderPiket();
            }
        });
    }

    function konfirmasiHapusSemua() {
        openM({
            icon: '‚ö†Ô∏è', title: 'Kosongkan Database?', msg: 'Anda akan menghapus SELURUH database izin siswa.',
            showInput: false, btnText: 'Ya, Hapus Semua', btnClass: 'btn-m-danger',
            onConfirm: () => {
                localStorage.removeItem('absensi_110');
                closeM(); renderPiket();
            }
        });
    }

    // FUNGSI STANDAR (TETAP SAMA)
    function updateDaftarSiswa() {
        const k = document.getElementById('kelas').value;
        const c = document.getElementById('containerNamaSiswa');
        if(dataSiswa[k]) {
            c.innerHTML = `<select id="namaSiswa"><option value="">-- Pilih Nama --</option>${dataSiswa[k].map(n => `<option value="${n}">${n}</option>`).join('')}</select>`;
        } else { c.innerHTML = `<input type="text" id="namaSiswa" placeholder="Pilih Kelas Dahulu" readonly />`; }
    }

    function navKe(id, btn) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-icons button').forEach(b => b.classList.remove('active-nav'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active-nav');
        if(id === 'menuWali') renderWali();
        if(id === 'menuPiket') renderPiket();
    }

    function buatSurat() {
        const nS = document.getElementById('namaSiswa').value, k = document.getElementById('kelas').value, nO = document.getElementById('namaOrtu').value, a = document.getElementById('alasan').value;
        if(!nS || nS === "" || !k || !nO) { alert("Lengkapi data!"); return; }
        const now = new Date();
        const item = { 
            id: Date.now(), 
            tglFull: now.toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' }), 
            nama: nS, kelas: k, ortu: nO.toUpperCase(), alasan: a 
        };
        currentData = item;
        let storage = JSON.parse(localStorage.getItem('absensi_110')) || [];
        storage.push(item);
        localStorage.setItem('absensi_110', JSON.stringify(storage));
        document.getElementById('inputFormWrapper').style.display = 'none';
        document.getElementById('outputSection').style.display = 'block';
        document.getElementById('surat').innerHTML = `
            <div style="text-align: right; margin-bottom: 25px;">Jakarta, ${item.tglFull}</div>
            <div style="margin-bottom: 20px;">Hal: <b>Permohonan Izin Tidak Masuk Sekolah</b></div>
            <div style="margin-bottom: 25px;">Yth. Bapak/Ibu Wali Kelas ${k}<br>SMPN 110 Jakarta</div>
            <p>Dengan hormat,</p>
            <p>Saya yang bertanda tangan di bawah ini adalah orang tua/wali murid dari:</p>
            <table class="table-surat">
                <tr><td class="label-col">Nama</td><td class="colon-col">:</td><td class="name-col">${nS}</td></tr>
                <tr><td class="label-col">Kelas</td><td class="colon-col">:</td><td>${k}</td></tr>
            </table>
            <p>Melalui surat ini kami memberitahukan bahwa anak tersebut di atas ${a === "Sakit" ? "sedang sakit" : "berhalangan hadir dikarenakan adanya urusan keluarga"}.</p>
            <p>Demikian surat ini kami sampaikan. Atas perhatian Bapak/Ibu, kami ucapkan terima kasih.</p>
            <div style="margin-top: 60px; float: right; text-align: center; width: 230px;">Hormat kami,<br><br><br><br><br>( <b>${item.ortu}</b> )</div><div style="clear:both"></div>`;
    }

    function kirimWhatsApp() {
        const msg = `Assalamu'alaikum, saya orang tua dari ${currentData.nama} (${currentData.kelas}). Menginfokan bahwa anak kami hari ini ${currentData.alasan}.`;
        window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`, '_blank');
    }

    function resetForm() { document.getElementById('inputFormWrapper').style.display = 'block'; document.getElementById('outputSection').style.display = 'none'; }

    function renderWali() {
        const s = JSON.parse(localStorage.getItem('absensi_110')) || [];
        document.getElementById('listWali').innerHTML = s.slice().reverse().map(d => `<tr><td>${d.kelas}</td><td>${d.nama}</td><td>${d.tglFull}</td><td>${d.alasan}</td></tr>`).join('') || '<tr><td colspan="4">Kosong</td></tr>';
    }

    function renderPiket() {
        const s = JSON.parse(localStorage.getItem('absensi_110')) || [];
        document.getElementById('listPiket').innerHTML = s.slice().reverse().map(d => `<tr><td>${d.kelas}</td><td>${d.nama}</td><td>${d.tglFull}</td><td><button onclick="konfirmasiHapusSatu(${d.id})" style="border:none; background:none; cursor:pointer;">‚ùå</button></td></tr>`).join('') || '<tr><td colspan="4">Kosong</td></tr>';
    }

    function sortTable(tId, n) {
        const table = document.getElementById(tId);
        let rows, sw, i, x, y, sh, dir, count = 0;
        sw = true; dir = "asc";
        while (sw) {
            sw = false; rows = table.rows;
            for (i = 1; i < (rows.length - 1); i++) {
                sh = false;
                x = rows[i].getElementsByTagName("TD")[n];
                y = rows[i + 1].getElementsByTagName("TD")[n];
                if (dir == "asc") { if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) { sh = true; break; }
                } else { if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) { sh = true; break; } }
            }
            if (sh) { rows[i].parentNode.insertBefore(rows[i + 1], rows[i]); sw = true; count ++;
            } else { if (count == 0 && dir == "asc") { dir = "desc"; sw = true; } }
        }
    }

    function exportCSV() {
        const data = JSON.parse(localStorage.getItem('absensi_110')) || [];
        let csv = "Kelas,Nama,Tanggal,Alasan\n" + data.map(d => `${d.kelas},${d.nama},${d.tglFull},${d.alasan}`).join("\n");
        const blob = new Blob([csv], { type: 'text/csv' });
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'Laporan_Izin_110.csv'; a.click();
    }
</script>
</body>
</html>