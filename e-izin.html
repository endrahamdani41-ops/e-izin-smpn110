<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>SMPN 110 JAKARTA</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
    <style>
        :root {
            --primary-color: #00C4CC;
            --bg-dark: #1e1e20;
            --input-bg: #252526;
            --border-color: #3e3e42;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #0f0f10 0%, #1a1a1b 100%);
            margin: 0; padding: 15px; color: #ffffff;
            min-height: 100vh; display: flex; flex-direction: column; align-items: center;
        }
        
        header, .container {
            width: 100%; max-width: 900px;
            box-sizing: border-box;
        }

        header {
            margin-bottom: 15px; background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px); padding: 10px 20px;
            border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex; justify-content: space-between; align-items: center;
        }

        header h1 { margin: 0; font-size: 1rem; }

        .nav-icons { display: flex; gap: 10px; }
        .nav-icons button {
            background: rgba(255, 255, 255, 0.1); border: none; color: white;
            width: 40px; height: 40px; border-radius: 10px; cursor: pointer;
            display: flex; align-items: center; justify-content: center; font-size: 1.2rem;
        }
        .nav-icons button.active-nav { background-color: var(--primary-color); }

        .container {
            padding: 25px; background-color: var(--bg-dark); 
            border-radius: 20px; box-shadow: 0 15px 35px rgba(0,0,0,0.5);
            border: 1px solid #2d2d30;
        }

        .section { display: none; }
        .active { display: block; }

        label { display: block; margin-bottom: 5px; font-weight: 600; color: #b3b3b3; font-size: 0.85rem; }
        input, select {
            padding: 12px; border-radius: 10px; border: 1px solid var(--border-color);
            width: 100%; background: var(--input-bg); color: #fff; margin-bottom: 15px;
            box-sizing: border-box; font-size: 1rem;
        }
        
        button.btn-primary {
            padding: 15px; border: none; border-radius: 10px; width: 100%;
            background: var(--primary-color); color: white; font-weight: bold; cursor: pointer;
        }

        table { width: 100%; border-collapse: collapse; font-size: 0.85rem; background: #fff; border-radius: 8px; overflow: hidden; }
        th { background: #2d2d30; color: var(--primary-color); padding: 12px; text-align: left; }
        td { padding: 10px; border-bottom: 1px solid #eee; color: #333 !important; }

        #surat { 
            background: white; color: black; padding: 40px; border-radius: 5px;
            font-family: 'Times New Roman', serif; line-height: 1.6; text-align: justify;
        }

        .action-bar { display: flex; justify-content: center; gap: 20px; margin-top: 25px; }
        .btn-icon {
            width: 55px; height: 55px; border-radius: 50%; border: none;
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            font-size: 1.5rem; color: white;
        }
        .btn-wa { background: #25D366; }
        .btn-print { background: var(--primary-color); }
        .btn-back { background: #444; }

        @media screen and (max-width: 600px) {
            body { padding: 10px; }
            .container { padding: 15px; }
            #surat { padding: 20px; font-size: 11pt; }
            header h1 { font-size: 0.8rem; }
        }

        @media print {
            body { background: white; padding: 0; }
            header, .nav-icons, .btn-primary, .action-bar { display: none !important; }
            .container { border: none; box-shadow: none; background: none; padding: 0; }
            #surat { display: block !important; padding: 0; }
        }
    </style>
</head>
<body>

<header>
    <h1>SMPN 110 JAKARTA</h1>
    <div class="nav-icons">
        <button onclick="bukaMenu('menuIsi', this)" class="active-nav">üìù</button>
        <button onclick="bukaMenu('menuWali', this)">üë®‚Äçüè´</button>
        <button onclick="bukaMenu('menuPiket', this)">üìã</button>
    </div>
</header>

<div class="container">
    <div id="menuIsi" class="section active">
        <div id="inputFormWrapper">
            <label>Pilih Kelas:</label>
            <select id="kelas" onchange="updateDaftarSiswa()">
                <option value="">-- Pilih Kelas --</option>
                <optgroup label="KELAS 7">
                    <option value="7 A">7 A</option><option value="7 B">7 B</option><option value="7 C">7 C</option>
                    <option value="7 D">7 D</option><option value="7 E">7 E</option><option value="7 F">7 F</option>
                </optgroup>
                <optgroup label="KELAS 8">
                    <option value="8 A">8 A</option><option value="8 B">8 B</option><option value="8 C">8 C</option>
                    <option value="8 D">8 D</option><option value="8 E">8 E</option><option value="8 F">8 F</option>
                </optgroup>
                <optgroup label="KELAS 9">
                    <option value="9 A">9 A</option><option value="9 B">9 B</option><option value="9 C">9 C</option>
                    <option value="9 D">9 D</option><option value="9 E">9 E</option><option value="9 F">9 F</option>
                </optgroup>
            </select>

            <label>Nama Murid:</label>
            <div id="containerNamaSiswa">
                <input type="text" id="namaSiswa" placeholder="Pilih Kelas Dahulu" readonly />
            </div>

            <label>Nama Orang Tua / Wali:</label>
            <input type="text" id="namaOrtu" style="text-transform: uppercase;" placeholder="NAMA LENGKAP" />
            
            <label>Keterangan:</label>
            <select id="alasan">
                <option value="Sakit">Sakit</option>
                <option value="Izin">Izin (Ada urusan keluarga)</option>
            </select>
            <button class="btn-primary" onclick="buatSurat()">Buat Surat Formal</button>
        </div>

        <div id="outputSection" style="display:none;">
            <div id="surat"></div>
            <div class="action-bar">
                <button class="btn-icon btn-back" onclick="resetForm()">‚Ü©Ô∏è</button>
                <button class="btn-icon btn-wa" onclick="kirimWA()">üí¨</button>
                <button class="btn-icon btn-print" onclick="window.print()">üñ®Ô∏è</button>
            </div>
        </div>
    </div>

    <div id="menuWali" class="section">
        <h3 style="color:var(--primary-color)">Laporan Wali Kelas</h3>
        <div id="filterWaliContainer"></div>
        <div style="max-height: 400px; overflow-y: auto; margin-top:10px;">
            <table>
                <thead><tr><th>Tanggal</th><th>Nama Murid</th><th>Ket.</th></tr></thead>
                <tbody id="listWali"></tbody>
            </table>
        </div>
    </div>

    <div id="menuPiket" class="section">
        <h3 style="color:var(--primary-color)">Rekap Ketidakhadiran</h3>
        <div style="max-height: 400px; overflow-y: auto;">
            <table>
                <thead><tr><th>Kelas</th><th>Tgl</th><th>Nama Murid</th><th>Ket.</th></tr></thead>
                <tbody id="listPiket"></tbody>
            </table>
        </div>
        <button onclick="clearData()" style="width:100%; margin-top:15px; background:none; color:#ff4d4d; border:1px solid #444; padding:10px; border-radius:10px; cursor:pointer;">Hapus Database</button>
    </div>
</div>

<script>
    const PASS_WALI = "wali110", PASS_PIKET = "piket110";

    // DATABASE NAMA SISWA (Bisa Anda isi di sini agar muncul otomatis saat pilih kelas)
    const dataSiswa = {
        "7 A": ["ABDUL FATAH", "ADDA KAAYUAN", "AHMAD DANI"],
        "7 B": ["BELLA", "BUDI", "BAMBANG"],
        "7 C": ["CITRA", "CACA"],
        // Anda bisa menambah kelas lainnya di sini dengan format yang sama
    };

    function updateDaftarSiswa() {
        const kelas = document.getElementById('kelas').value;
        const container = document.getElementById('containerNamaSiswa');
        
        if (dataSiswa[kelas]) {
            let options = dataSiswa[kelas].map(n => `<option value="${n}">${n}</option>`).join('');
            container.innerHTML = `<select id="namaSiswa">${options}</select>`;
        } else {
            container.innerHTML = `<input type="text" id="namaSiswa" placeholder="Ketik Nama Murid" />`;
        }
    }

    function buatSurat() {
        const nSiswa = document.getElementById('namaSiswa').value;
        const kls = document.getElementById('kelas').value;
        const nOrtu = document.getElementById('namaOrtu').value;
        const ket = document.getElementById('alasan').value;

        if(!nSiswa || !kls || !nOrtu) return alert("Lengkapi data!");

        const now = new Date();
        const tglFull = now.toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' });
        
        const data = {
            id: Date.now(),
            tglLengkap: now.toLocaleDateString('id-ID', { day: 'numeric', month: 'short' }),
            nama: nSiswa, kelas: kls, ortu: nOrtu.toUpperCase(), alasan: ket
        };
        let storage = JSON.parse(localStorage.getItem('absensi_110')) || [];
        storage.push(data);
        localStorage.setItem('absensi_110', JSON.stringify(storage));

        document.getElementById('inputFormWrapper').style.display = 'none';
        document.getElementById('outputSection').style.display = 'block';
        document.getElementById('surat').style.display = 'block';
        
        document.getElementById('surat').innerHTML = `
            <div style="text-align: right; margin-bottom: 30px;">Jakarta, ${tglFull}</div>
            <div style="margin-bottom: 25px;">Yth. Bapak/Ibu Wali Kelas ${kls}<br>SMPN 110 Jakarta</div>
            <p>Dengan hormat, saya orang tua/wali dari:</p>
            <table style="width: auto; border: none; background: none; margin-left: 0;">
                <tr>
                    <td style="border: none; padding: 2px 0; width: 55px; color: black !important;">Nama</td>
                    <td style="border: none; padding: 2px 5px; width: 10px; color: black !important;">:</td>
                    <td style="border: none; padding: 2px 0; color: black !important;"><b>${nSiswa}</b></td>
                </tr>
                <tr>
                    <td style="border: none; padding: 2px 0; color: black !important;">Kelas</td>
                    <td style="border: none; padding: 2px 5px; color: black !important;">:</td>
                    <td style="border: none; padding: 2px 0; color: black !important;">${kls}</td>
                </tr>
            </table>
            <p style="margin-top: 20px;">Memberitahukan bahwa anak kami tersebut di atas ${ket === "Sakit" ? "sedang sakit" : "berhalangan hadir karena urusan keluarga"}.</p>
            <p>Demikian surat ini kami sampaikan. Terima kasih.</p>
            <div style="margin-top: 50px; float: right; text-align: center; min-width: 200px;">
                Hormat kami,<br><br><br><br>
                ( <b>${nOrtu.toUpperCase()}</b> )
            </div>
            <div style="clear: both;"></div>
        `;
    }

    // Fungsi Navigasi & Render lainnya tetap sama (Disederhanakan)
    function bukaMenu(menuId, btn) {
        if (menuId === 'menuWali' && prompt("Password Wali Kelas:") !== PASS_WALI) return;
        if (menuId === 'menuPiket' && prompt("Password Guru Piket:") !== PASS_PIKET) return;
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-icons button').forEach(b => b.classList.remove('active-nav'));
        document.getElementById(menuId).classList.add('active');
        btn.classList.add('active-nav');
        if(menuId === 'menuWali') renderDataWali();
        if(menuId === 'menuPiket') renderDataPiket();
    }

    function renderDataWali() {
        const storage = JSON.parse(localStorage.getItem('absensi_110')) || [];
        document.getElementById('listWali').innerHTML = storage.reverse().map(d => `<tr><td>${d.tglLengkap}</td><td>${d.nama}</td><td>${d.alasan}</td></tr>`).join('') || '<tr><td colspan="3" style="text-align:center">Data Kosong</td></tr>';
    }

    function renderDataPiket() {
        const storage = JSON.parse(localStorage.getItem('absensi_110')) || [];
        document.getElementById('listPiket').innerHTML = storage.reverse().map(d => `<tr><td>${d.kelas}</td><td>${d.tglLengkap}</td><td>${d.nama}</td><td>${d.alasan}</td></tr>`).join('') || '<tr><td colspan="4" style="text-align:center">Data Kosong</td></tr>';
    }

    function resetForm() { document.getElementById('inputFormWrapper').style.display = 'block'; document.getElementById('outputSection').style.display = 'none'; }
    function clearData() { if(confirm("Hapus data?")) { localStorage.removeItem('absensi_110'); renderDataPiket(); } }
    function kirimWA() {
        const n = document.getElementById('namaSiswa').value;
        const text = `*IZIN SISWA SMPN 110*\n\nMemberitahukan bahwa *${n}* hari ini izin/sakit.`;
        window.open(`https://wa.me/?text=${encodeURIComponent(text)}`);
    }
</script>
</body>
</html>